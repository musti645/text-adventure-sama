!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("@angular/core"),require("lodash"),require("@angular/common"),require("@angular/forms"),require("natural")):"function"==typeof define&&define.amd?define("text-adventure-sama",["exports","rxjs","@angular/core","lodash","@angular/common","@angular/forms","natural"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["text-adventure-sama"]={},t.rxjs,t.ng.core,t._,t.ng.common,t.ng.forms,t.natural)}(this,(function(t,e,n,o,s,i,r){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function u(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}Object.create;function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;var p=function(){function t(){}return t.prototype.activate=function(){return this.Response?this.Response:this.ResponseFunction()},t.prototype.setTrigger=function(t){this.Trigger=t},t.prototype.getTrigger=function(){return this.Trigger},t.prototype.setResponse=function(t){this.Response=t},t.prototype.getResponse=function(){return this.Response},t.prototype.setResponseFunction=function(t){this.ResponseFunction=t},t.prototype.getResponseFunction=function(){return this.ResponseFunction},t.prototype.setUseTypeWritingAnimation=function(t){this.UseTypeWritingAnimation=t},t.prototype.getUseTypeWritingAnimation=function(){return this.UseTypeWritingAnimation},t.prototype.getDescription=function(){return this.Description},t.prototype.setDescription=function(t){this.Description=t},t}(),d=function(){function t(){this.ItemConsumingActionEventSource=new e.Subject,this.ItemYieldingActionEventSource=new e.Subject,this.ItemRemovingActionEventSource=new e.Subject,this.ItemConsumingActionEvent$=this.ItemConsumingActionEventSource.asObservable(),this.ItemYieldingActionEvent$=this.ItemYieldingActionEventSource.asObservable(),this.ItemRemovingActionEvent$=this.ItemRemovingActionEventSource.asObservable()}return t.getInstance=function(){return t.Instance||(t.Instance=new t),t.Instance},t.prototype.consumeItem=function(t){this.ItemConsumingActionEventSource.next(t)},t.prototype.yieldItem=function(t){this.ItemYieldingActionEventSource.next(t)},t.prototype.removeItem=function(t){this.ItemRemovingActionEventSource.next(t)},t}();d.Instance=void 0,d.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new d},token:d,providedIn:"root"}),d.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],d.ctorParameters=function(){return[]};var h=function(){function t(){var t=this;this.Items=[],d.getInstance().ItemYieldingActionEvent$.subscribe((function(e){return t.OnItemYield(e)})),d.getInstance().ItemRemovingActionEvent$.subscribe((function(e){return t.OnItemRemove(e)})),d.getInstance().ItemConsumingActionEvent$.subscribe((function(e){return t.OnItemConsume(e)}))}return t.prototype.OnItemYield=function(t){t.ResetItemUsagesToMaximum&&t.Item.resetUsages();for(var e=0;e<t.AmountOfItems;e++)this.addItem(o.cloneDeep(t.Item))},t.prototype.OnItemRemove=function(t){this.removeItemFromInventory(t.Item.getID())},t.prototype.OnItemConsume=function(t){this.findItemsById(t.Item.getID())[0].use()},t.prototype.findItemsById=function(t){return this.Items.filter((function(e){return e.getID()===t}))},t.prototype.findItemsByName=function(t){return this.Items.filter((function(e){return e.getName()===t}))},t.prototype.removeItemFromInventory=function(t){this.Items=this.Items.filter((function(e){return e.getID()!==t}))},t.prototype.getItemCount=function(){return this.Items.length},t.prototype.addItem=function(t){t.WasPickedUp=!0,this.Items.push(t)},t.prototype.getItems=function(){return this.Items},t}(),f=function(t){function e(n){var o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return u(e,t),e}(Error),m=function(){function t(){this.GatewayActionEventSource=new e.Subject,this.GatewayActionEvent$=this.GatewayActionEventSource.asObservable()}return t.getInstance=function(){return t.Instance||(t.Instance=new t),t.Instance},t.prototype.changeScene=function(t){this.GatewayActionEventSource.next(t)},t}();m.Instance=void 0,m.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new m},token:m,providedIn:"root"}),m.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],m.ctorParameters=function(){return[]};var g,I=function(){function t(){var t=this;this.ScenePath=[],this.Scenes=[],m.getInstance().GatewayActionEvent$.subscribe((function(e){return t.OnSceneChange(e)}))}return t.prototype.OnSceneChange=function(t){this.goToScene(t.TargetSceneID)},t.prototype.getCurrentScene=function(){return this.CurrentScene||(this.CurrentScene=this.Scenes[0]),this.CurrentScene},t.prototype.goToScene=function(t){var e=this.Scenes.find((function(e){return e.getID()===t}));if(!e)throw new f("Scene could not be found.");return this.ScenePath.push(t),this.CurrentScene=e,this.CurrentScene},t.prototype.addScene=function(t){this.Scenes.push(t)},t.prototype.getScenesCount=function(){return this.Scenes.length},t.prototype.getScenes=function(){return this.Scenes},t}(),y=function(){function t(){this.Stage=new I,this.Inventory=new h,this.Commands=[],this.initializeCommands()}return t.prototype.initializeCommands=function(){var t=this,e=new p;e.setTrigger("help"),e.setDescription("A list of all global commands"),e.setUseTypeWritingAnimation(!1),e.setResponseFunction((function(){var e="";return t.Commands.forEach((function(t){e+=t.getTrigger()+" - "+t.getDescription()+" \r\n "})),e})),this.Commands.push(e);var n=new p;n.setTrigger("inventory"),n.setDescription("List all items in your inventory."),n.setUseTypeWritingAnimation(!1),n.setResponseFunction((function(){if(t.Inventory.getItemCount()<=0)return t.InventoryEmptyResponse;var e="Items in Inventory: \r\n ";return t.Inventory.getItems().forEach((function(t){e+=t.getName()+" \r\n "})),e})),this.Commands.push(n);var o=new p;o.setTrigger("look around"),o.setDescription("Get a description of the scene you're in"),o.setUseTypeWritingAnimation(!0),o.setResponseFunction((function(){var e,n,o=t.Stage.getCurrentScene().getDescription();try{for(var s=c(t.Stage.getCurrentScene().getItems()),i=s.next();!i.done;i=s.next()){o+=" "+i.value.getInSceneDescription()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o})),this.Commands.push(o)},t.prototype.getStage=function(){return this.Stage},t.prototype.getInventory=function(){return this.Inventory},t.prototype.setInventory=function(t){this.Inventory=t},t.prototype.getScenesCount=function(){return this.Stage.getScenesCount()},t.prototype.getTitle=function(){return this.Title},t.prototype.setTitle=function(t){this.Title=t},t.prototype.getIntroduction=function(){return this.Introduction},t.prototype.setIntroduction=function(t){this.Introduction=t},t.prototype.getCommands=function(){return this.Commands},t.prototype.setCommands=function(t){this.Commands=t},t.prototype.getItemNotFoundResponse=function(){return this.Stage.getCurrentScene().getItemNotFoundResponse()},t.prototype.getInvalidInputResponse=function(){return this.Stage.getCurrentScene().getInvalidInputResponse()},t.prototype.getActionNotRecognizedResponse=function(){return this.Stage.getCurrentScene().getActionNotRecognizedResponse()},t.prototype.getSceneDescription=function(){return this.Stage.getCurrentScene().getDescription()},t.prototype.getItemNotFoundInInventoryResponse=function(){return this.ItemNotFoundInInventoryResponse},t.prototype.setItemNotFoundInInventoryResponse=function(t){this.ItemNotFoundInInventoryResponse=t},t.prototype.getActionsInScene=function(){return this.Stage.getCurrentScene().getActions()},t.prototype.getItemsInScene=function(){return this.Stage.getCurrentScene().getItems()},t.prototype.getItemsInInventory=function(){return this.Inventory.getItems()},t.prototype.removeItemFromScene=function(t){this.Stage.getCurrentScene().removeItemFromScene(t)},t.prototype.addItemToInventory=function(t){this.Inventory.addItem(t)},t.prototype.removeItemFromInventory=function(t){this.Inventory.removeItemFromInventory(t.getID())},t.prototype.getItemAddedToInventoryResponse=function(){return this.ItemAddedToInventoryResponse},t.prototype.setItemAddedToInventoryResponse=function(t){this.ItemAddedToInventoryResponse=t},t.prototype.getGatewayTargetNotFoundResponse=function(){return this.GatewayTargetNotFoundResponse},t.prototype.setGatewayTargetNotFoundResponse=function(t){this.GatewayTargetNotFoundResponse=t},t.prototype.getInventoryEmptyResponse=function(){return this.InventoryEmptyResponse},t.prototype.setInventoryEmptyResponse=function(t){this.InventoryEmptyResponse=t},t}(),l=function(){},w=function(){function t(t){this.ID=t,this.CanPickUp=!0}return t.prototype.CanUseFunction=function(t,e,n){return!0},t.prototype.use=function(){return this.UsagesLeft>=1?(this.UsagesLeft--,this.ItemUsedResponse):this.NoUsagesLeftResponse},t.prototype.resetUsages=function(){this.UsagesLeft=this.MaximumUsages},t.prototype.setID=function(t){this.ID=t},t.prototype.getID=function(){return this.ID},t.prototype.setName=function(t){this.Name=t},t.prototype.getName=function(){return this.Name},t.prototype.setDescription=function(t){this.Description=t},t.prototype.getDescription=function(){return this.Description},t.prototype.setMaximumUsages=function(t){this.MaximumUsages=t},t.prototype.getMaximumUsages=function(){return this.MaximumUsages},t.prototype.setUsagesLeft=function(t){this.UsagesLeft=t},t.prototype.getUsagesLeft=function(){return this.UsagesLeft},t.prototype.setItemUsedResponse=function(t){this.ItemUsedResponse=t},t.prototype.getItemUsedResponse=function(){return this.ItemUsedResponse},t.prototype.setNoUsagesLeftResponse=function(t){this.NoUsagesLeftResponse=t},t.prototype.getNoUsagesLeftResponse=function(){return this.NoUsagesLeftResponse},t.prototype.getCanPickUp=function(){return this.CanPickUp},t.prototype.setCanPickUp=function(t){this.CanPickUp=t},t.prototype.setCannotPickUpResponse=function(t){this.CannotPickUpResponse=t},t.prototype.getCannotPickUpResponse=function(){return this.CannotPickUpResponse},t.prototype.getInSceneDescription=function(){return this.InSceneDescription},t.prototype.setInSceneDescription=function(t){this.InSceneDescription=t},t.prototype.setCanUseFunction=function(t){this.CanUseFunction=t},t.prototype.setCannotUseItemResponse=function(t){this.CannotUseItemResponse=t},t.prototype.getCannotUseItemResponse=function(){return this.CannotUseItemResponse},t.prototype.getCanUseFunction=function(){return this.CanUseFunction},t}(),v=function(t){function e(n){var o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return u(e,t),e}(Error),R=function(t){function e(e,n,o){void 0===n&&(n=new w),void 0===o&&(o=!1);var s=t.call(this)||this;return s.Item=n,s.Builder=e,s.RequireInSceneDescription=o,s}return u(e,t),e.prototype.setName=function(t){if(!t)throw new EvalError("Name was undefined");return this.Item.setName(t),this},e.prototype.setDescription=function(t){if(!t)throw new EvalError("Description was undefined");return this.Item.setDescription(t),this},e.prototype.setMaximumUsages=function(t){if(void 0===t||t<=0)throw new EvalError("MaximumUsages Value has to be greater than 0.");if(this.Item.getUsagesLeft()&&this.Item.getUsagesLeft()>t)throw new EvalError("MaximumUsages Value has to be greater or equal to the UsagesLeft Value");return this.Item.setMaximumUsages(t),this},e.prototype.setUsagesLeft=function(t){if(null==t||t<0)throw new EvalError("UsagesLeft Value has to be greater than or equal to 0.");if(this.Item.getMaximumUsages()&&t>this.Item.getMaximumUsages())throw new EvalError("UsagesLeft Value has to be less or equal to the MaximumUsages Value.");return this.Item.setUsagesLeft(t),this},e.prototype.setItemUsedResponse=function(t){if(!t)throw new EvalError("ItemUsedResponse was undefined.");return this.Item.setItemUsedResponse(t),this},e.prototype.setNoUsagesLeftResponse=function(t){if(!t)throw new EvalError("NoUsagesLeftResponse was undefined.");return this.Item.setNoUsagesLeftResponse(t),this},e.prototype.setCanPickUp=function(t){return this.Item.setCanPickUp(t),this},e.prototype.setCannotPickUpResponse=function(t){if(!t)throw new EvalError("CannotPickUpResponse was undefined.");return this.Item.setCannotPickUpResponse(t),this},e.prototype.setInSceneDescription=function(t){if(!t)throw new EvalError("InSceneDescription was undefined.");return this.Item.setInSceneDescription(t),this},e.prototype.setCanUseFunction=function(t){if(!t)throw new EvalError("CanUseFunction was undefined.");return this.IsCanUseFunctionReplaced=!0,this.Item.setCanUseFunction(t),this},e.prototype.setCannotUseItemResponse=function(t){if(!t)throw new EvalError("CannotUseItemResponse was undefined");return this.Item.setCannotUseItemResponse(t),this},e.prototype.finish=function(){if(!this.Item.getName())throw new v("Item creation could not be finished. Name was not set.");if(!this.Item.getDescription())throw new v("Item creation could not be finished. Description was not set.");if(this.Item.getUsagesLeft()>0&&!this.Item.getItemUsedResponse())throw new v("Item creation could not be finished. ItemUsedResponse was not set.");if(!this.Item.getNoUsagesLeftResponse())throw new v("Item creation could not be finished. NoUsagesLeftResponse was not set.");if(!this.Item.getCanPickUp()&&!this.Item.getCannotPickUpResponse())throw new v("Item creation could not be finished. CannotPickUpResponse was not set.");if(this.RequireInSceneDescription&&!this.Item.getInSceneDescription())throw new v("Item creation could not be finished. InSceneDescription was not set.");if(this.IsCanUseFunctionReplaced&&!this.Item.getCannotUseItemResponse())throw new v("Item creation could not be finished. CannotUseItemResponse was not set.");return this.Item.getMaximumUsages()<0&&this.Item.setMaximumUsages(1),this.Item.getUsagesLeft()<0&&this.Item.setUsagesLeft(1),this.Builder.addItemToBuilder(this.Item),this.Builder},e}(l),T=function(t){function e(e,n){var o=t.call(this)||this;return o.GameBuilder=e,o.Game=n,o.Inventory=new h,o}return u(e,t),e.prototype.addItem=function(t){return new R(this,t)},e.prototype.addItemToBuilder=function(t){if(!t)throw new v("Could not add Item to Inventory. Item was not set.");this.Inventory.addItem(t),t.getID()&&this.GameBuilder.IdGeneratorService.addItemId(t)},e.prototype.finish=function(){return this.Game.setInventory(this.Inventory),this.GameBuilder},e}(l),U=function(){function t(t){this.ID=t,this.Items=[],this.Actions=[]}return t.prototype.setID=function(t){this.ID=t},t.prototype.getID=function(){return this.ID},t.prototype.getName=function(){return this.Name},t.prototype.setName=function(t){this.Name=t},t.prototype.getDescription=function(){return this.Description},t.prototype.setDescription=function(t){this.Description=t},t.prototype.getActionNotRecognizedResponse=function(){return this.ActionNotRecognizedResponse},t.prototype.setActionNotRecognizedResponse=function(t){this.ActionNotRecognizedResponse=t},t.prototype.getItemNotFoundResponse=function(){return this.ItemNotFoundResponse},t.prototype.setItemNotFoundResponse=function(t){this.ItemNotFoundResponse=t},t.prototype.getInvalidInputResponse=function(){return this.InvalidInputResponse},t.prototype.setInvalidInputResponse=function(t){this.InvalidInputResponse=t},t.prototype.getActions=function(){return this.Actions},t.prototype.getItems=function(){return this.Items},t.prototype.removeItemFromScene=function(t){var e=this.Items.indexOf(t);e>-1&&this.Items.splice(e,1)},t}(),A=function(t){function e(e,n){var o=t.call(this)||this;return o.Action=n,o.Builder=e,o}return u(e,t),e.prototype.setTrigger=function(t){if(!t||""===t)throw new EvalError("No Trigger found.");return this.Action.setTrigger(t),this},e.prototype.setResponse=function(t){if(!t||""===t)throw new EvalError("No Response found.");return this.Action.setResponse(t),this},e.prototype.setEndGameAction=function(){return this.Action.setIsEndGameAction(!0),this},e.prototype.onFinish=function(){},e.prototype.finish=function(){if(!this.Action.getTrigger())throw new v("Action creation could not be finished. Trigger was not set.");if(!this.Action.getResponse())throw new v("Action creation could not be finished. Response was not set.");return this.onFinish(),this.Builder.addActionToBuilder(this.Action),this.Builder},e}(l);(g=t.InteractionType||(t.InteractionType={}))[g.USE=0]="USE",g[g.LOOK_AT=1]="LOOK_AT",g[g.GO_TO=2]="GO_TO",g[g.PICK_UP=3]="PICK_UP",g[g.DO=4]="DO";var D=function(){function t(){this.IsEndGameAction=!1}return t.prototype.setTrigger=function(t){this.Trigger=t},t.prototype.setInteractionType=function(t){this.InteractionType=t},t.prototype.setResponse=function(t){this.Response=t},t.prototype.setIsEndGameAction=function(t){this.IsEndGameAction=t},t.prototype.getTrigger=function(){return this.Trigger},t.prototype.getIsEndGameAction=function(){return this.IsEndGameAction},t.prototype.getInteractionType=function(){return this.InteractionType},t.prototype.getResponse=function(){return this.Response},t}(),E=function(e){function n(){var n=e.call(this)||this;return n.setInteractionType(t.InteractionType.DO),n}return u(n,e),n.prototype.trigger=function(){return this.WasTriggered?this.ResponseAfterUse:(this.WasTriggered=!0,this.getResponse())},n.prototype.reset=function(){this.WasTriggered=!1},n.prototype.getWasTriggered=function(){return this.WasTriggered},n.prototype.setWasTriggered=function(t){this.WasTriggered=t},n.prototype.getResponseAfterUse=function(){return this.ResponseAfterUse},n.prototype.setResponseAfterUse=function(t){this.ResponseAfterUse=t},n}(D),S=function(t){this.Item=t.getItem(),this.Response=t.getResponse(),this.ResponseAfterUse=t.getResponseAfterUse(),this.WasTriggered=t.getWasTriggered(),this.AmountOfItems=t.getAmountOfItems(),this.ResetItemUsagesToMaximum=t.getResetItemUsagesToMaximum()},C=function(e){function n(){var n=e.call(this)||this;return n.AmountOfItems=1,n.setInteractionType(t.InteractionType.DO),n}return u(n,e),n.prototype.trigger=function(){return this.getWasTriggered()?this.getResponseAfterUse():(d.getInstance().yieldItem(new S(this)),this.setWasTriggered(!0),this.getResponse())},n.prototype.reset=function(){this.setWasTriggered(!1)},n.prototype.getItem=function(){return this.Item},n.prototype.setItem=function(t){this.Item=t},n.prototype.setAmountOfItems=function(t){this.AmountOfItems=t},n.prototype.getAmountOfItems=function(){return this.AmountOfItems},n.prototype.getResetItemUsagesToMaximum=function(){return this.ResetItemUsagesToMaximum},n.prototype.setResetItemUsagesToMaximum=function(t){this.ResetItemUsagesToMaximum=t},n}(E),b=function(t){this.TargetSceneID=t.getTargetSceneId(),this.TargetSceneName=t.getTargetSceneName()},N=function(e){function n(){var n=e.call(this)||this;return n.setInteractionType(t.InteractionType.GO_TO),n}return u(n,e),n.prototype.trigger=function(){return m.getInstance().changeScene(new b(this)),this.getResponse()},n.prototype.reset=function(){},n.prototype.getTargetSceneId=function(){return this.TargetSceneId},n.prototype.setTargetSceneId=function(t){this.TargetSceneId=t},n.prototype.getTargetSceneName=function(){return this.TargetSceneName},n.prototype.setTargetSceneName=function(t){this.TargetSceneName=t},n}(D),G=function(t){function e(e){return t.call(this,e,new N)||this}return u(e,t),e.prototype.setTargetSceneId=function(t){if(void 0===t||t<=0)throw new EvalError("TargetSceneId Value has to be greater than 0.");return this.Action.setTargetSceneId(t),this},e.prototype.setTargetSceneName=function(t){if(!t)throw new EvalError("TargetSceneName Value is invalid.");return this.Action.setTargetSceneName(t),this},e.prototype.onFinish=function(){if(!this.Action.getTargetSceneId()&&!this.Action.getTargetSceneName())throw new v("Action creation could not be finished. SceneId and/or TargetSceneName were not set.")},e}(A),O=function(t){this.Item=t.getItem(),this.Response=t.getResponse(),this.ResponseAfterUse=t.getResponseAfterUse(),this.WasTriggered=t.getWasTriggered()},F=function(e){function n(){var n=e.call(this)||this;return n.setInteractionType(t.InteractionType.USE),n}return u(n,e),n.prototype.trigger=function(){return this.getWasTriggered()?this.getResponseAfterUse():(d.getInstance().consumeItem(new O(this)),this.setWasTriggered(!0),this.getResponse())},n.prototype.reset=function(){this.setWasTriggered(!1)},n.prototype.getItem=function(){return this.Item},n.prototype.setItem=function(t){this.Item=t},n}(E),k=function(e){function n(t){return e.call(this,t,new F)||this}return u(n,e),n.prototype.setWasTrigered=function(t){if(null==t)throw new EvalError("WasTriggered was not set.");return this.Action.setWasTriggered(t),this},n.prototype.setResponseAfterUse=function(t){if(!t||""===t)throw new EvalError("No Response found.");return this.Action.setResponseAfterUse(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.addItemToBuilder=function(t){if(!t)throw new v("Item could not be added to the Action. Item was not set.");this.Action.setItem(t)},n.prototype.addItem=function(t){return new R(this,t)},n.prototype.onFinish=function(){if(!this.Action.getItem())throw new v("Action creation could not be finished. Item was not set.");if(!this.Action.getResponseAfterUse())throw new v("Action creation could not be finished. ResponseAfterUse was not set.")},n}(A),L=function(t){this.Item=t.getItem(),this.Response=t.getResponse(),this.ResponseAfterUse=t.getResponseAfterUse(),this.WasTriggered=t.getWasTriggered()},x=function(e){function n(){var n=e.call(this)||this;return n.setInteractionType(t.InteractionType.USE),n}return u(n,e),n.prototype.trigger=function(){return this.getWasTriggered()?this.getResponseAfterUse():(d.getInstance().removeItem(new L(this)),this.setWasTriggered(!0),this.getResponse())},n.prototype.reset=function(){this.setWasTriggered(!1)},n.prototype.getItem=function(){return this.Item},n.prototype.setItem=function(t){this.Item=t},n}(E),P=function(e){function n(t){return e.call(this,t,new x)||this}return u(n,e),n.prototype.addItemToBuilder=function(t){if(!t)throw new v("Item could not be added to the Action. Item was not set.");this.Action.setItem(t)},n.prototype.setWasTrigered=function(t){if(null==t)throw new EvalError("WasTriggered was not set.");return this.Action.setWasTriggered(t),this},n.prototype.setResponseAfterUse=function(t){if(!t||""===t)throw new EvalError("No Response found.");return this.Action.setResponseAfterUse(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.addItem=function(t){return new R(this,t)},n.prototype.onFinish=function(){if(!this.Action.getItem())throw new v("Action creation could not be finished. Item was not set.");if(!this.Action.getResponseAfterUse())throw new v("Action creation could not be finished. ResponseAfterUse was not set.")},n}(A),_=function(e){function n(t){return e.call(this,t,new C)||this}return u(n,e),n.prototype.addItemToBuilder=function(t){if(!t)throw new v("Item could not be added to the Action. Item was not set.");this.Action.setItem(t)},n.prototype.addItem=function(t){return new R(this,t)},n.prototype.setWasTrigered=function(t){if(null==t)throw new EvalError("WasTriggered was not set.");return this.Action.setWasTriggered(t),this},n.prototype.setResponseAfterUse=function(t){if(!t||""===t)throw new EvalError("No Response found.");return this.Action.setResponseAfterUse(t),this},n.prototype.setAmountOfItems=function(t){if(void 0===t||t<=0)throw new EvalError("AmountOfItems Value has to be greater than 0.");return this.Action.setAmountOfItems(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.setResetItemUsagesToMaximum=function(t){if(null==t)throw new EvalError("WasTriggered was not set.");return this.Action.setResetItemUsagesToMaximum(t),this},n.prototype.onFinish=function(){if(!this.Action.getItem())throw new v("Action creation could not be finished. Item was not set.");if(!this.Action.getResponseAfterUse())throw new v("Action creation could not be finished. ResponseAfterUse was not set.")},n}(A),W=function(e){function n(){var n=e.call(this)||this;return n.setInteractionType(t.InteractionType.DO),n}return u(n,e),n.prototype.trigger=function(){if(this.UsagesLeft<=this.MaximumUsages){var t=this.Responses[this.UsagesLeft];return this.UsagesLeft++,t}return this.getResponse()},n.prototype.reset=function(){this.UsagesLeft=0},n.prototype.getUsagesLeft=function(){return this.UsagesLeft},n.prototype.setUsagesLeft=function(t){this.UsagesLeft=t},n.prototype.getMaximumUsages=function(){return this.MaximumUsages},n.prototype.setMaximumUsages=function(t){this.MaximumUsages=t},n.prototype.getResponses=function(){return this.Responses},n.prototype.setResponses=function(t){this.Responses=t},n}(D),M=function(e){function n(t){return e.call(this,t,new W)||this}return u(n,e),n.prototype.setUsagesLeft=function(t){if(void 0===t||t<=0)throw new EvalError("UsagesLeft Value has to be greater than 0.");if(this.Action.getMaximumUsages()&&this.Action.getMaximumUsages()<t)throw new EvalError("UsagesLeft Value has to be less than or equal to MaximumUsages Value.");return this.Action.setUsagesLeft(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.setMaximumUsages=function(t){if(void 0===t||t<=0)throw new EvalError("MaximumUsages Value has to be greater than 0.");if(void 0!==this.Action.getUsagesLeft()&&this.Action.getUsagesLeft()>t)throw new EvalError("MaximumUsages Value has to be greater than or equal to UsagesLeft Value.");if(this.Action.getResponses()&&this.Action.getResponses().length!==t)throw new EvalError("MaximumUsages Value has to match the Amount of Responses.");return this.Action.setMaximumUsages(t),this},n.prototype.setResponses=function(t){if(!t)throw new EvalError("Invalid Value for Responses. Has to be an Array of Strings.");if(0===t.length)throw new EvalError("Responses Array may not be empty.");return this.Action.setResponses(t),this},n.prototype.onFinish=function(){if(!this.Action.getUsagesLeft())throw new v("Action creation could not be finished. UsagesLeft was not set.");if(!this.Action.getMaximumUsages())throw new v("Action creation could not be finished. MaximumUsages was not set.");if(!this.Action.getResponses())throw new v("Action creation could not be finished. Responses Array was not set.");if(!this.Action.getInteractionType())throw new v("Action creation could not be finished. InteractionType was not set.")},n}(A),B=function(e){function n(){var n=e.call(this)||this;return n.setResponse(" "),n.setInteractionType(t.InteractionType.DO),n}return u(n,e),n.prototype.trigger=function(){var t=Math.floor(Math.random()*this.Responses.length);return this.Responses[t]},n.prototype.reset=function(){},n.prototype.getResponses=function(){return this.Responses},n.prototype.setResponses=function(t){this.Responses=t},n}(D),j=function(e){function n(t){return e.call(this,t,new B)||this}return u(n,e),n.prototype.setResponses=function(t){if(!t)throw new EvalError("Invalid Value for Responses. Has to be an Array of Strings.");if(0===t.length)throw new EvalError("Responses Array may not be empty.");return this.Action.setResponses(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.onFinish=function(){if(!this.Action.getResponses())throw new v("Action creation could not be finished. Responses Array was not set.");if(!this.Action.getInteractionType())throw new v("Action creation could not be finished. InteractionType was not set.")},n}(A),V=function(e){function n(t){return e.call(this,t,new E)||this}return u(n,e),n.prototype.setWasTrigered=function(t){if(null==t)throw new EvalError("WasTriggered was not set.");return this.Action.setWasTriggered(t),this},n.prototype.setResponseAfterUse=function(t){if(!t||""===t)throw new EvalError("No Response found.");return this.Action.setResponseAfterUse(t),this},n.prototype.setInteractionType=function(e){if(!e||!Object.values(t.InteractionType).includes(e))throw new EvalError("InteractionType not set.");return this.Action.setInteractionType(e),this},n.prototype.onFinish=function(){if(!this.Action.getResponseAfterUse())throw new v("Action creation could not be finished. ResponseAfterUse was not set.");if(!this.Action.getInteractionType())throw new v("Action creation could not be finished. InteractionType was not set.")},n}(A),z=function(t){function e(e,n,o){void 0===o&&(o=null);var s=t.call(this)||this;return s.GameBuilder=e,s.Game=n,s.Scene=new U(o),s}return u(e,t),e.prototype.addActionToBuilder=function(t){this.Scene.getActions().push(t),t instanceof C&&this.GameBuilder.IdGeneratorService.addActionItemId(t)},e.prototype.addAction=function(t){return new A(this,t)},e.prototype.addGatewayAction=function(){return new G(this)},e.prototype.addItemConsumingAction=function(){return new k(this)},e.prototype.addItemRemovingAction=function(){return new P(this)},e.prototype.addItemYieldingAction=function(){return new _(this)},e.prototype.addMultiTimeAction=function(t){return new M(this)},e.prototype.addOneTimeAction=function(){return new V(this)},e.prototype.addRandomResponseAction=function(){return new j(this)},e.prototype.addItemToBuilder=function(t){this.Scene.getItems().push(t),t.getID()&&this.GameBuilder.IdGeneratorService.addItemId(t)},e.prototype.addItem=function(t){return new R(this,t)},e.prototype.setName=function(t){if(!t)throw new EvalError("Name was not set.");return this.Scene.setName(t),this},e.prototype.setDescription=function(t){if(!t)throw new EvalError("Description was not set.");return this.Scene.setDescription(t),this},e.prototype.setActionNotRecognizedResponse=function(t){if(!t)throw new EvalError("ActionNotRecognizedResponse was not set.");return this.Scene.setActionNotRecognizedResponse(t),this},e.prototype.setItemNotFoundResponse=function(t){if(!t)throw new EvalError("ItemNotFoundResponse was not set.");return this.Scene.setItemNotFoundResponse(t),this},e.prototype.setInvalidInputResponse=function(t){if(!t)throw new EvalError("InvalidInputResponse was not set.");return this.Scene.setInvalidInputResponse(t),this},e.prototype.finish=function(){if(!this.Scene.getName())throw new v("Scene creation could not be finished. Name was not set.");if(!this.Scene.getDescription())throw new v("Scene creation could not be finished. Description was not set.");if(!this.Scene.getInvalidInputResponse())throw new v("Scene creation could not be finished. InvalidInputResponse was not set.");if(!this.Scene.getItemNotFoundResponse())throw new v("Scene creation could not be finished. ItemNotFoundResponse was not set.");if(!this.Scene.getActionNotRecognizedResponse())throw new v("Scene creation could not be finished. ActionNotRecognizedResponse was not set.");return this.Game.getStage().addScene(this.Scene),this.GameBuilder},e}(l),q=function(){function t(){this.typeArray=[]}return t.prototype.generateIDs=function(t){this.processScenes(t.getStage().getScenes()),this.typeArray=[]},t.prototype.processScenes=function(t){var e=this;t.forEach((function(t){t.getID()?e.setUsedIdForTypeName(t.constructor.name,t.getID()):t.setID(e.getIdFromTypeName(t.constructor.name)),e.processActions(t.getActions()),e.processItems(t.getItems())}))},t.prototype.processActions=function(t){var e=this;t.forEach((function(t){t instanceof C&&!t.getItem().getID()&&t.getItem().setID(e.getIdFromTypeName(t.constructor.name))}))},t.prototype.processItems=function(t){var e=this;t.forEach((function(t){t.getID()?e.setUsedIdForTypeName(t.constructor.name,t.getID()):t.setID(e.getIdFromTypeName(t.constructor.name))}))},t.prototype.getIdFromTypeName=function(t){var e=this.typeArray.findIndex((function(e){return e.Name===t}));return-1!==e?this.typeArray[e].getAndIncrementCount():this.createTypeCountContainer(t).getAndIncrementCount()},t.prototype.addItemId=function(t){this.setUsedIdForTypeName(t.constructor.name,t.getID())},t.prototype.addSceneId=function(t){this.setUsedIdForTypeName(t.constructor.name,t.getID())},t.prototype.addActionItemId=function(t){this.setUsedIdForTypeName(t.getItem().constructor.name,t.getItem().getID())},t.prototype.setUsedIdForTypeName=function(t,e){var n=this.typeArray.findIndex((function(e){return e.Name===t}));-1===n?this.createTypeCountContainer(t).addUsedID(e):this.typeArray[n].addUsedID(e)},t.prototype.createTypeCountContainer=function(t){var e=new Y(t);return this.typeArray.push(e),e},t.prototype.getTypeCountContainers=function(){return this.typeArray},t}();q.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new q},token:q,providedIn:"root"}),q.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],q.ctorParameters=function(){return[]};var K,Y=function(){function t(t){this.Name=t,this.Count=0,this.UsedIDs=[]}return t.prototype.getAndIncrementCount=function(){for(this.Count++;this.isCurrentCountUsed();)this.Count++;return this.addUsedID(this.Count),this.Count},t.prototype.addUsedID=function(t){if(this.isIdUsed(t))throw new EvalError("Id is already being used.");this.UsedIDs.push(t)},t.prototype.isCurrentCountUsed=function(){var t=this;return this.UsedIDs.filter((function(e){return e===t.Count})).length>0},t.prototype.isIdUsed=function(t){return!!this.UsedIDs.find((function(e){return e===t}))},t}(),$=function(t){function e(e,n){void 0===n&&(n=new p);var o=t.call(this)||this;return o.Command=n,o.Builder=e,o}return u(e,t),e.prototype.setTrigger=function(t){if(!t)throw new EvalError("Trigger was undefined.");return this.Command.setTrigger(t),this},e.prototype.setResponse=function(t){if(!t)throw new EvalError("Response was undefined.");return this.Command.setResponse(t),this},e.prototype.setResponseFunction=function(t){if(!t)throw new EvalError("ResponseFunction was undefined.");return this.Command.setResponseFunction(t),this},e.prototype.setUseTypeWritingAnimation=function(t){if(null==t)throw new EvalError("UseTypeWritingAnimation was undefined.");return this.Command.setUseTypeWritingAnimation(t),this},e.prototype.setDescription=function(t){if(!t)throw new EvalError("Description was undefined");return this.Command.setDescription(t),this},e.prototype.finish=function(){if(!this.Command.getTrigger())throw new v("Could not create Command. Trigger was not set.");if(!this.Command.getDescription())throw new v("Could not create Command. Description was not set.");if(!this.Command.getResponse()&&!this.Command.getResponseFunction())throw new v("Could not create Command. Response and ResponseFunction were not set. One of both is required.");return void 0!==this.Command.getUseTypeWritingAnimation()&&null!==this.Command.getUseTypeWritingAnimation()||this.Command.setUseTypeWritingAnimation(!0),this.Builder.addCommandToBuilder(this.Command),this.Builder},e}(l),H=function(t){function e(){var e=t.call(this)||this;return e.Game=new y,e.IdGeneratorService=new q,e}return u(e,t),e.prototype.addInventory=function(){return new T(this,this.Game)},e.prototype.addScene=function(t){return new z(this,this.Game,t)},e.prototype.addCommand=function(){return new $(this)},e.prototype.addCommandToBuilder=function(t){if(!t)throw new v("Command was undefined");return this.Game.getCommands().push(t),this},e.prototype.removeExistingCommands=function(){return this.Game.setCommands([]),this},e.prototype.setTitle=function(t){if(!t)throw new EvalError("Title was undefined.");return this.Game.setTitle(t),this},e.prototype.setIntroduction=function(t){if(!t)throw new EvalError("Introduction was undefined.");return this.Game.setIntroduction(t),this},e.prototype.setItemNotFoundInInventoryResponse=function(t){if(!t)throw new EvalError("ItemNotFoundInInventoryResponse was undefined.");return this.Game.setItemNotFoundInInventoryResponse(t),this},e.prototype.setItemAddedToInventoryResponse=function(t){if(!t)throw new EvalError("ItemAddedToInventoryResponse was undefined.");return this.Game.setItemAddedToInventoryResponse(t),this},e.prototype.setGatewayTargetNotFoundResponse=function(t){if(!t)throw new EvalError("GatewayTargetNotFoundResponse was undefined.");return this.Game.setGatewayTargetNotFoundResponse(t),this},e.prototype.setInventoryEmptyResponse=function(t){if(!t)throw new EvalError("InventoryEmptyResponse was undefined.");return this.Game.setInventoryEmptyResponse(t),this},e.prototype.finish=function(){if(!this.Game.getTitle())throw new v("Game creation could not be finished. Title was not set.");if(!this.Game.getIntroduction())throw new v("Game creation could not be finished. Introduction was not set.");if(!this.Game.getItemAddedToInventoryResponse())throw new v("Game creation could not be finished. ItemAddedToInventoryResponse was not set.");if(!this.Game.getItemNotFoundInInventoryResponse())throw new v("Game creation could not be finished. ItemNotFoundInInventoryResponse was not set.");if(!this.Game.getGatewayTargetNotFoundResponse())throw new v("Game creation could not be finished. GatewayTargetNotFoundResponse was not set.");if(!this.Game.getInventoryEmptyResponse())throw new v("Game creation could not be finished. InventoryEmptyResponse was not set.");if(this.Game.getScenesCount()<=0)throw new v("Game creation could not be finished. No Scenes were found.");return this.generateUnassignedIds(),this.Game},e.prototype.generateUnassignedIds=function(){this.IdGeneratorService.generateIDs(this.Game)},e}(l),Z=function(){function t(t){this.ID=t,this.CanPickUp=!0}return t.prototype.CanUseFunction=function(t,e,n){return!0},t.prototype.use=function(){return this.UsagesLeft>=1?(this.UsagesLeft--,this.ItemUsedResponse):this.NoUsagesLeftResponse},t.prototype.resetUsages=function(){this.UsagesLeft=this.MaximumUsages},t.prototype.setID=function(t){this.ID=t},t.prototype.getID=function(){return this.ID},t.prototype.setName=function(t){this.Name=t},t.prototype.getName=function(){return this.Name},t.prototype.setDescription=function(t){this.Description=t},t.prototype.getDescription=function(){return this.Description},t.prototype.setMaximumUsages=function(t){this.MaximumUsages=t},t.prototype.getMaximumUsages=function(){return this.MaximumUsages},t.prototype.setUsagesLeft=function(t){this.UsagesLeft=t},t.prototype.getUsagesLeft=function(){return this.UsagesLeft},t.prototype.setItemUsedResponse=function(t){this.ItemUsedResponse=t},t.prototype.getItemUsedResponse=function(){return this.ItemUsedResponse},t.prototype.setNoUsagesLeftResponse=function(t){this.NoUsagesLeftResponse=t},t.prototype.getNoUsagesLeftResponse=function(){return this.NoUsagesLeftResponse},t.prototype.getCanPickUp=function(){return this.CanPickUp},t.prototype.setCanPickUp=function(t){this.CanPickUp=t},t.prototype.setCannotPickUpResponse=function(t){this.CannotPickUpResponse=t},t.prototype.getCannotPickUpResponse=function(){return this.CannotPickUpResponse},t.prototype.getInSceneDescription=function(){return this.InSceneDescription},t.prototype.setInSceneDescription=function(t){this.InSceneDescription=t},t.prototype.setCanUseFunction=function(t){this.CanUseFunction=t},t.prototype.setCannotUseItemResponse=function(t){this.CannotUseItemResponse=t},t.prototype.getCannotUseItemResponse=function(){return this.CannotUseItemResponse},t.prototype.getCanUseFunction=function(){return this.CanUseFunction},t}();!function(t){t.UserInput="input",t.Output="output"}(K||(K={}));var J=function(t,e){this.Value=t,this.Type=e},Q=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.Result=t,this.UseTypewriterAnimation=e,this.IsEndGameResult=n},X=["N","NN","NNS","NNP","NNPS"],tt=["VB","VBD","VBG","VBN","VBO","VBZ"],et=function(){function e(){}return e.prototype.initialize=function(t){var e=this;return new Promise((function(n){e.Tokenizer=new r.WordTokenizer;var o=new r.Lexicon("EN","N","NNP"),s=new r.RuleSet("EN");e.POSTagger=new r.BrillPOSTagger(o,s),e.Classifier=new r.BayesClassifier,t.trainClassifier(e.Classifier).then((function(){return n(!0)}))}))},e.prototype.setGame=function(t){this.Game=t},e.prototype.parseInput=function(e){var n=this.getCommandsResponse(e);if(n)return n;e="they "+e;var o=this.POSTagger.tag(this.Tokenizer.tokenize(e)).taggedWords,s=this.getNounsAndVerbsFromTokenizedInput(o),i=this.getInteractionType(e);if(null==i)return new Q(this.Game.getInvalidInputResponse());switch(i){case t.InteractionType.GO_TO:return this.getGoToResponse(s);case t.InteractionType.LOOK_AT:return this.getLookAtResponse(s);case t.InteractionType.PICK_UP:return this.getPickUpResponse(s);case t.InteractionType.USE:return this.getUseResponse(s);default:return this.getDoResponse(s)}},e.prototype.getCommandsResponse=function(t){var e,n=t.toLocaleLowerCase();return this.Game.getCommands().some((function(t){if(t.getTrigger().toLocaleLowerCase()===n)return e=new Q(t.activate(),t.getUseTypeWritingAnimation()),!0})),e},e.prototype.getGoToResponse=function(e){var n=new Q(""),o=this.Game.getActionsInScene().filter((function(e){return e.getInteractionType()===t.InteractionType.GO_TO}));if(!o||o.length<=0)return n.Result=this.Game.getGatewayTargetNotFoundResponse(),n;var s=this.getActionDistancesFromNouns(e,o);if(!s||s.length<=0)return n.Result=this.Game.getGatewayTargetNotFoundResponse(),n;var i=s[0].Action;return n.Result=i.trigger(),n.IsEndGameResult=i.getIsEndGameAction(),n},e.prototype.getLookAtResponse=function(t){var e=new Q(""),n=this.getItemDistancesFromNouns(t,this.Game.getItemsInScene(),this.Game.getItemsInInventory());return!n||n.length<=0?(e.Result=this.Game.getItemNotFoundResponse(),e):(e.Result=n[0].Item.getDescription(),e)},e.prototype.getPickUpResponse=function(t){var e=new Q(""),n=this.getItemDistancesFromNouns(t,this.Game.getItemsInScene(),void 0);if(!n||n.length<=0)return e.Result=this.Game.getItemNotFoundResponse(),e;var o=n[0].Item;return o.getCanPickUp()?o.getUsagesLeft()<=0?(e.Result=o.getNoUsagesLeftResponse(),e):(this.Game.addItemToInventory(o),this.Game.removeItemFromScene(o),e.Result=this.Game.getItemAddedToInventoryResponse(),e):(e.Result=o.getCannotPickUpResponse(),e)},e.prototype.getUseResponse=function(t){var e=new Q(""),n=this.getItemDistancesFromNouns(t,this.Game.getItemsInScene(),this.Game.getItemsInInventory());if(!n||n.length<=0)return e.Result=this.Game.getItemNotFoundResponse(),e;var o=n[0].Item;return o.CanUseFunction(o,this.Game.getStage().getCurrentScene(),this.Game.getInventory())?(e.Result=o.use(),o.WasPickedUp&&o.getUsagesLeft()<=0&&(e.Result+="\r\n"+o.getNoUsagesLeftResponse(),this.Game.removeItemFromInventory(o)),e):(e.Result=o.getCannotUseItemResponse(),e)},e.prototype.getDoResponse=function(e){var n=new Q(""),o=this.Game.getActionsInScene().filter((function(e){return e.getInteractionType()===t.InteractionType.DO}));if(!o||o.length<=0)return n.Result=this.Game.getActionNotRecognizedResponse(),n;var s=this.getActionDistancesFromNouns(e,o);if(!s||s.length<=0)return n.Result=this.Game.getActionNotRecognizedResponse(),n;var i=s[0].Action;return n.Result=i.trigger(),n.IsEndGameResult=i.getIsEndGameAction(),n},e.prototype.getNounsAndVerbsFromTokenizedInput=function(t){return t.reduce((function(t,e){return(X.includes(e.tag)||tt.includes(e.tag))&&t.push(e.token),t}),[])},e.prototype.getItemDistancesFromNouns=function(t,e,n){var o=this,s=[],i=[];return e&&(i=i.concat(e)),n&&(i=i.concat(n)),i.map((function(e){o.POSTagger.tag(o.Tokenizer.tokenize(e.Name)).taggedWords.map((function(n){t.map((function(t){var o=r.DamerauLevenshteinDistance(t,n.token,{transposition_cost:0});o<=1&&s.push(new ot(e,o))}))}))})),s.sort((function(t){return t.Distance}))},e.prototype.getActionDistancesFromNouns=function(t,e){var n=this,o=[];return e.map((function(e){n.POSTagger.tag(n.Tokenizer.tokenize(e.getTrigger())).taggedWords.map((function(n){t.map((function(t){var s=r.DamerauLevenshteinDistance(t,n.token,{transposition_cost:0});s<=1&&o.push(new nt(e,s))}))}))})),o.sort((function(t){return t.Distance}))},e.prototype.getInteractionType=function(t){var e=this.Classifier.classify(t);return this.getInteractionTypeFromClassificationResult(e)},e.prototype.getInteractionTypeFromClassificationResult=function(e){switch(e){case"use":return t.InteractionType.USE;case"look_at":return t.InteractionType.LOOK_AT;case"go_to":return t.InteractionType.GO_TO;case"pick_up":return t.InteractionType.PICK_UP;case"do":default:return t.InteractionType.DO}},e}();et.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new et},token:et,providedIn:"root"}),et.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],et.ctorParameters=function(){return[]};var nt=function(t,e){this.Action=t,this.Distance=e},ot=function(t,e){this.Item=t,this.Distance=e},st=function(){function t(){}return t.prototype.trainClassifier=function(t){return new Promise((function(e){t.addDocument("use keys","use"),t.addDocument("use knob","use"),t.addDocument("use old pen","use"),t.addDocument("use rusty knife","use"),t.addDocument("open door","use"),t.addDocument("open oven","use"),t.addDocument("open window","use"),t.addDocument("interact with animal","use"),t.addDocument("interact person","use"),t.addDocument("close door","use"),t.addDocument("close chest","use"),t.addDocument("shut window","use"),t.addDocument("shut the lid","use"),t.addDocument("drink soda","use"),t.addDocument("drink water","use"),t.addDocument("eat mushrooms","use"),t.addDocument("eat food","use"),t.addDocument("look at house","look_at"),t.addDocument("look at the chair","look_at"),t.addDocument("inspect door","look_at"),t.addDocument("inspect knife","look_at"),t.addDocument("check window","look_at"),t.addDocument("check fireplace","look_at"),t.addDocument("analyze notes","look_at"),t.addDocument("analyze keys","look_at"),t.addDocument("read book","look_at"),t.addDocument("read letter","look_at"),t.addDocument("observe darkness","look_at"),t.addDocument("observe forrest","look_at"),t.addDocument("go inside","go_to"),t.addDocument("go outside","go_to"),t.addDocument("enter building","go_to"),t.addDocument("enter home","go_to"),t.addDocument("leave house","go_to"),t.addDocument("leave hut","go_to"),t.addDocument("run away","go_to"),t.addDocument("run into the darkness","go_to"),t.addDocument("walk to place","go_to"),t.addDocument("walk to the shed","go_to"),t.addDocument("walk into the bar","go_to"),t.addDocument("go to Peter","go_to"),t.addDocument("go in to the forrest","go_to"),t.addDocument("go into the cellar","go_to"),t.addDocument("take keys","pick_up"),t.addDocument("take up book","pick_up"),t.addDocument("take notebook","pick_up"),t.addDocument("pick up a lighter","pick_up"),t.addDocument("pick up leash","pick_up"),t.addDocument("put something into bag","pick_up"),t.addDocument("put water bottle into inventory","pick_up"),t.addDocument("gather mushrooms","pick_up"),t.addDocument("collect stones","pick_up"),t.addDocument("acquire medal","pick_up"),t.addDocument("dance","do"),t.addDocument("sit","do"),t.addDocument("stand","do"),t.addDocument("sleep","do"),t.addDocument("fish","do"),t.addDocument("do","do"),t.addDocument("write","do"),t.addDocument("read","do"),t.addDocument("find","do"),t.addDocument("work","do"),t.addDocument("try","do"),t.addDocument("feel","do"),t.addDocument("create","do"),t.addDocument("speak","do"),t.addDocument("talk","do"),t.addDocument("offer","do"),t.addDocument("buy","do"),t.addDocument("kill","do"),t.addDocument("beat","do"),t.addDocument("harm","do"),t.addDocument("jump","do"),t.addDocument("sell","do"),t.addDocument("pull","do"),t.addDocument("push","do"),t.addDocument("put","do"),t.events.on("trainedWithDocument",(function(){return e()})),t.train(),e()}))},t}();st.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new st},token:st,providedIn:"root"}),st.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}];var it=function(t){},rt=function(t){},at=function(){},ut=function(){function t(t){this.inputParserService=t,this.OutputArray=[],this.IsLoading=!1,this.UseTypewritingAnimation=!0,this.TypewriterSpeed=40,this.OnGameStartEvent=new n.EventEmitter,this.OnGameResetEvent=new n.EventEmitter,this.OnGameEndEvent=new n.EventEmitter,this.InputForm=new i.FormGroup({userInput:new i.FormControl({value:"",disabled:this.IsLoading},[i.Validators.required])}),this.ClassificationTrainer?t.initialize(this.ClassificationTrainer):t.initialize(new st)}return t.prototype.ngOnInit=function(){if(this.startLoading(),!this.Game)throw new f("Game not found.");this.startGame()},t.prototype.OnSubmit=function(){var t=this;this.startLoading();var e=this.userInput.value;if(e){this.printInput(e),this.userInput.setValue("");var n=this.inputParserService.parseInput(e);this.printOutput(n.Result,n.UseTypewriterAnimation).then((function(){return t.stopLoading()}))}else this.stopLoading()},t.prototype.OnGameReset=function(){this.OnGameResetEvent.emit(new it(this.Game))},t.prototype.OnGameEnd=function(){this.OnGameEndEvent.emit(new rt(this.Game))},Object.defineProperty(t.prototype,"userInput",{get:function(){return this.InputForm.get("userInput")},enumerable:!1,configurable:!0}),t.prototype.startLoading=function(){this.IsLoading=!0,this.userInput.disable()},t.prototype.stopLoading=function(){var t=this;this.IsLoading=!1,this.userInput.enable(),setTimeout((function(){t.inputElement.nativeElement.focus()}))},t.prototype.startGame=function(){var t=this;this.inputParserService.setGame(this.Game),this.OnGameStartEvent.emit(new at),this.printOutput(this.Game.getTitle()).then((function(){return t.printOutput(t.Game.getIntroduction())})).then((function(){return t.stopLoading()}))},t.prototype.printOutput=function(t,e){var n=this;return void 0===e&&(e=!0),new Promise((function(o){var s,i;if(e&&n.UseTypewritingAnimation){var r=t.split("\r\n"),a=new Promise((function(t){return t()})),u=function(t){a=a.then((function(){return n.printLineAnimated(t)}))};try{for(var p=c(r),d=p.next();!d.done;d=p.next()){u(d.value)}}catch(t){s={error:t}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(s)throw s.error}}a=a.then(o)}else t=t.split("\r\n").join("<br>"),n.OutputArray.push(new J(t,K.Output)),o()}))},t.prototype.printLineAnimated=function(t){var e=this;return new Promise((function(n){e.OutputArray.push(new J("",K.Output)),e.typewriteOutput(0,t,e.OutputArray,n)}))},t.prototype.typewriteOutput=function(t,e,n,o){var s=this;t>=e.length&&o();var i=e.charAt(t);n[n.length-1].Value+=i,t++,setTimeout((function(){s.typewriteOutput(t,e,s.OutputArray,o)}),this.TypewriterSpeed)},t.prototype.printInput=function(t){this.OutputArray.push(new J(t,K.UserInput))},t}();ut.decorators=[{type:n.Component,args:[{selector:"tas-text-adventure",template:'<div class="container-fluid text-adventure-root h-100 w-100">\r\n  <div class="row output-container-wrapper">\r\n    <div class="output-container">\r\n      <table>\r\n        <tbody>\r\n          <tr *ngFor="let line of OutputArray; let index = i"\r\n            [ngClass]="line.Type  === \'input\'? \'input-line\' : \'output-line\'">\r\n            <td [innerHTML]=\'line.Value\'></td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n  <div class="row input-container-wrapper">\r\n    <div class="row input-container">\r\n      <form [formGroup]="InputForm" (ngSubmit)="OnSubmit()">\r\n        <div class="form-group">\r\n          <input type="text" class="form-control" #input formControlName="userInput" autofocus>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".text-adventure-root{background:#222;color:#ddd;font-family:Lucida Sans Typewriter,Lucida Console,monaco,Bitstream Vera Sans Mono,monospace;height:100%;margin:0}.text-adventure-root .row{margin:0}.text-adventure-root .output-container-wrapper{display:flex;flex-direction:column-reverse;height:95%;overflow:hidden;padding:8px}.text-adventure-root .output-container-wrapper .output-container{display:flex;text-overflow:ellipsis}.text-adventure-root .output-container-wrapper .output-container .input-line{font-style:italic}.text-adventure-root .input-container-wrapper .input-container form .form-group input{background-color:#222;border-radius:0;border-top:1px solid #ddd;border-width:0;box-sizing:border-box;color:#ddd;padding:8px;width:100%}"]}]}],ut.ctorParameters=function(){return[{type:et}]},ut.propDecorators={inputElement:[{type:n.ViewChild,args:["input",{static:!0}]}],UseTypewritingAnimation:[{type:n.Input}],TypewriterSpeed:[{type:n.Input}],Game:[{type:n.Input}],ClassificationTrainer:[{type:n.Input}],OnGameStartEvent:[{type:n.Output}],OnGameResetEvent:[{type:n.Output}],OnGameEndEvent:[{type:n.Output}]};var ct=function(){};ct.decorators=[{type:n.NgModule,args:[{imports:[i.ReactiveFormsModule,s.CommonModule],declarations:[ut],exports:[ut]}]}],t.Command=p,t.CommandBuilder=$,t.Game=y,t.GameBuilder=H,t.InGameItem=Z,t.Inventory=h,t.InventoryBuilder=T,t.ItemBuilder=R,t.Scene=U,t.SceneBuilder=z,t.Stage=I,t.TextAdventureComponent=ut,t.TextAdventureModule=ct,t.ɵa=l,t.ɵb=w,t.ɵc=et,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=text-adventure-sama.umd.min.js.map